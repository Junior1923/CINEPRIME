@model IEnumerable<CINE_PRIME.ViewModels.WatchlistItemVM>

@{
    ViewData["Title"] = "Mi Lista Pendiente";
}

@section Styles {
    <link rel="stylesheet" href="~/css/watchList.css" />
}

<section class="container mt-4">
    <h2 class="text-info fw-bold mb-4">
        🕒 Mi Lista para Ver Más Tarde
    </h2>

    @if (!Model.Any())
    {
        <div class="text-center text-muted mt-5">
            <h4>No tienes elementos en tu lista pendiente.</h4>
            <p>Explora películas y series para agregarlas aquí.</p>
            <a asp-controller="Movies" asp-action="Index" class="btn btn-info mt-3 text-white">
                Explorar contenido
            </a>
        </div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var item in Model)
            {
                var posterUrl = !string.IsNullOrEmpty(item.Poster)
                ? $"https://image.tmdb.org/t/p/w500{item.Poster}"
                : "/img/no-poster.png";

                <div class="col-6 col-md-4 col-lg-3">
                    <div class="watch-card shadow-lg">

                        <!-- Imagen -->
                        <div class="poster-container">
                            <img src="@posterUrl" class="poster-img" alt="@item.Title" />

                            <div class="overlay">
                                <span class="media-tag">
                                    @(item.MediaType == "movie" ? "Película" : "Serie")
                                </span>
                            </div>
                        </div>

                        <!-- Info -->
                        <div class="p-3">
                            <h5 class="title">@item.Title</h5>

                            <p class="small text-muted mb-1">
                                ⭐ @item.Rating.ToString("0.0")
                            </p>

                            <p class="small text-secondary">
                                @item.ReleaseDate
                            </p>

                            <div class="mt-3 d-flex justify-content-between">
                                <a asp-controller="@(item.MediaType == "movie" ? "Movies" : "Series")"
                                   asp-action="Details"
                                   asp-route-id="@item.MediaId"
                                   class="btn btn-sm btn-info text-white">
                                    Ver detalles
                                </a>

                                <form asp-action="Remove" method="post">
                                    <input type="hidden" name="listaId" value="@item.WatchlistId" />
                                    <button type="submit"
                                            class="btn btn-sm btn-outline-danger">
                                        ✖ Quitar
                                    </button>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>
    }
</section>