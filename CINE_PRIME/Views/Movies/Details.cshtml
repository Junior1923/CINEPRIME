@model CINE_PRIME.ViewModels.MovieDetailsViewModel

@{
    ViewData["Title"] = Model.Movie.Title;

    var bg = $"https://image.tmdb.org/t/p/original{Model.Movie.BackdropPath}";
    var poster = $"https://image.tmdb.org/t/p/w500{Model.Movie.PosterPath}";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Details.css" />
}

<div class="details-hero" style="background-image: url('@bg');">
    <div class="overlay"></div>

    <div class="details-content container">
        <div class="poster-box">
            <img src="@poster" alt="@Model.Movie.Title" class="poster-img" />
        </div>

        <div class="info">
            <h1 class="movie-title">@Model.Movie.Title</h1>

            <div class="meta">
                <span class="rating">⭐ @Model.Movie.VoteAverage.ToString("0.0")</span>
                <span class="date">📅 @Model.Movie.ReleaseDate</span>
            </div>

            <p class="overview">@Model.Movie.Overview</p>

            @if (User.Identity.IsAuthenticated)
            {
                <div class="actions">
                    <form asp-controller="Favorites" asp-action="Add" method="post">
                        <input type="hidden" name="movieId" value="@Model.Movie.Id" />
                        <button class="btn-main">❤️ Añadir a Favoritos</button>
                    </form>

                    <form asp-controller="Watchlist" asp-action="Add" method="post">
                        <input type="hidden" name="movieId" value="@Model.Movie.Id" />
                        <button class="btn-outline">🕒 Guardar para ver luego</button>
                    </form>
                </div>
            }
            else
            {
                <a asp-controller="Account" asp-action="Login" class="btn-login">
                    Inicia sesión para marcar esta película
                </a>
            }
        </div>
    </div>
</div>

<div class="container trailer-section text-light mt-5">
    @if (!string.IsNullOrEmpty(Model.TrailerKey))
    {
        <h2 class="trailer-title">🎞️ Tráiler Oficial</h2>
        <div class="ratio ratio-16x9 trailer-box">
            <iframe src="@Model.TrailerKey" frameborder="0" allowfullscreen></iframe>
        </div>
    }
    else
    {
        <p class="text-muted">No hay tráiler disponible.</p>
    }

    <a asp-action="Index" class="btn-back mt-4">⬅ Volver</a>
</div>
